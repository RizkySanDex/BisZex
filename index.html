<!--
  FlixPro ‚Äî Full HTML Template (Blogger + GitHub + Netlify compatible)
  - Save as `index.html` for Netlify/GitHub hosting OR paste into a Blogger HTML/Theme widget.
  - This template can fetch posts from Blogger using the Blogger v3 API (client-side).
  - IMPORTANT: Do NOT embed your API key in public repos. Use Netlify Functions / server-side proxy for production.

  USAGE
  1) Replace API_KEY below with your Blogger API Key only for local testing. For production, set up a serverless function (Netlify) and point API_PROXY.
  2) Set BLOG_ID to your Blogger numeric ID (already set below).
  3) In Blogger, create posts with a consistent format: include a YouTube iframe or an <img> poster and use Labels as genres (e.g. "livestream", "short").

  Notes:
  - This file contains a fallback mode (load sample movies from local JSON) when API is not configured.
  - Template supports: search, filter by label, hero trailer, modal player, Next/Prev (keyboard), watchlist (localStorage), dark toggle.
-->

<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FlixPro ‚Äî Film & Trailer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--muted:#98a0b3;--accent:#ff5a5f;--glass:rgba(255,255,255,0.04);--radius:14px;--max-width:1200px;--transition:300ms cubic-bezier(.2,.9,.3,1)}
    *{box-sizing:border-box}html,body{height:100%}body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial;line-height:1.4;background:linear-gradient(180deg,#071023 0%,var(--bg) 100%);color:#eaf1ff;min-height:100%;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;padding:28px 20px;display:flex;justify-content:center}
    .container{width:100%;max-width:var(--max-width)}header{display:flex;align-items:center;justify-content:space-between;margin-bottom:28px;gap:16px}.brand{display:flex;align-items:center;gap:14px}.logo{width:56px;height:56px;background:linear-gradient(135deg,var(--accent),#ff8a5c);border-radius:12px;display:grid;place-items:center;font-weight:800;font-family:'Playfair Display',serif;color:white}.brand h1{margin:0;font-size:20px}.brand p{margin:0;font-size:12px;color:var(--muted)}.controls{display:flex;gap:12px;align-items:center}.search{background:var(--card);border-radius:12px;padding:10px 12px;display:flex;align-items:center;gap:10px;min-width:260px}.search input{background:transparent;border:0;color:inherit;outline:none;font-size:14px;width:100%}.btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:10px 14px;border-radius:10px;cursor:pointer;transition:all var(--transition)}.btn:hover{transform:translateY(-3px)}.filters{display:flex;gap:8px;flex-wrap:wrap}.chip{padding:8px 12px;border-radius:999px;background:var(--glass);color:var(--muted);font-size:13px;cursor:pointer;border:1px solid rgba(255,255,255,0.02)}.chip.active{background:linear-gradient(90deg,rgba(255,90,95,0.12),rgba(255,138,92,0.08));color:var(--accent);border-color:rgba(255,90,95,0.2)}main{margin-top:18px}.hero{display:grid;grid-template-columns:1fr 320px;gap:20px;margin-bottom:22px}.hero-card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:20px;border-radius:18px;position:relative;overflow:hidden}.hero .poster{height:260px;border-radius:12px;overflow:hidden;background:#081226}.poster img{width:100%;height:100%;object-fit:cover;display:block}.meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px}.meta .title{font-family:'Playfair Display',serif;font-size:20px}.meta .rating{background:rgba(0,0,0,0.35);padding:6px 10px;border-radius:10px}.sidebar{background:var(--card);border-radius:14px;padding:18px;height:100%;display:flex;flex-direction:column;gap:12px}.sidebar h3{margin:0 0 6px 0}.mini-list{display:grid;gap:10px}.mini-item{display:flex;gap:10px;align-items:center}.mini-item img{width:64px;height:40px;object-fit:cover;border-radius:8px}.mini-item .t{font-size:13px}.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:18px}.card{background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:12px;overflow:hidden;cursor:pointer;transition:transform var(--transition),box-shadow var(--transition)}.card:hover{transform:translateY(-10px);box-shadow:0 18px 40px rgba(12,20,30,0.6)}.thumb{height:170px;background:#061122}.thumb img{width:100%;height:100%;object-fit:cover;display:block}.card .info{padding:12px}.title-small{font-weight:600;margin:0 0 6px 0}.meta-row{display:flex;justify-content:space-between;font-size:13px;color:var(--muted)}.actions{display:flex;gap:8px;margin-top:12px}.pill{padding:8px 10px;border-radius:10px;font-size:13px;border:1px solid rgba(255,255,255,0.03)}footer{margin-top:28px;color:var(--muted);font-size:13px;text-align:center}.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(0deg,rgba(2,6,23,0.7),rgba(2,6,23,0.7));z-index:9999;padding:28px}.modal.open{display:flex}.modal-card{width:min(1000px,95%);background:#071226;border-radius:14px;overflow:hidden}.modal-top{display:flex;gap:18px;padding:18px}.modal-video{flex:1;min-height:420px;background:black}.modal-info{width:320px;padding:18px;color:var(--muted)}.close{position:absolute;right:24px;top:22px;background:transparent;border:0;color:#fff;font-size:18px}@media (max-width:1000px){.grid{grid-template-columns:repeat(3,1fr)}.hero{grid-template-columns:1fr 260px}}@media (max-width:800px){.grid{grid-template-columns:repeat(2,1fr)}.hero{grid-template-columns:1fr}.sidebar{order:3;height:auto}}@media (max-width:480px){body{padding:14px}.grid{grid-template-columns:1fr}.search{min-width:140px}.logo{width:44px;height:44px}}.muted{color:var(--muted)}.hidden{display:none}@keyframes pop{0%{transform:scale(.98)}50%{transform:scale(1.02)}100%{transform:scale(1)}}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">FP</div>
        <div>
          <h1>FlixPro</h1>
          <p class="muted">Discover films ‚Ä¢ trailers ‚Ä¢ reviews</p>
        </div>
      </div>

      <div class="controls">
        <div class="search" role="search">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#cbd6ea" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
          <input id="q" placeholder="Cari film, aktor, genre..." aria-label="Cari film" />
        </div>
        <div class="filters" id="filters">
          <button class="chip active" data-genre="All">Semua</button>
        </div>
        <button id="darkToggle" class="btn" aria-label="Toggle dark mode">üåô</button>
      </div>
    </header>

    <main>
      <section class="hero">
        <div class="hero-card">
          <div class="poster" id="heroPoster">
            <img src="https://images.unsplash.com/photo-1505685296765-3a2736de412f?q=80&w=1600&auto=format&fit=crop" alt="Poster">
          </div>
          <div class="meta">
            <div>
              <div class="title" id="heroTitle">A New Dawn</div>
              <div class="muted" id="heroMeta">Action ‚Ä¢ 2024 ‚Ä¢ 2h 11m</div>
            </div>
            <div class="rating" id="heroRating">‚≠ê 8.5</div>
          </div>
          <p class="muted" style="margin-top:12px" id="heroDesc">Sebuah kisah epik tentang keberanian, pengorbanan, dan harapan. Trailer resmi tersedia untuk ditonton.</p>
          <div class="actions">
            <button class="pill" id="playHero">Tonton Trailer</button>
            <button class="pill" id="addHero">Tambahkan ke Watchlist</button>
          </div>
        </div>

        <aside class="sidebar">
          <h3>Trending saat ini</h3>
          <div class="mini-list" id="trendingList"></div>

          <h3 style="margin-top:8px">Filter by Year</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap">
            <button class="chip" data-year="2024">2024</button>
            <button class="chip" data-year="2023">2023</button>
            <button class="chip" data-year="2022">2022</button>
          </div>
        </aside>
      </section>

      <section>
        <h2 style="margin:0 0 12px 0">Popular Movies</h2>
        <div class="grid" id="grid"></div>
        <div style="text-align:center;margin-top:18px">
          <button id="loadMore" class="btn">Load more</button>
        </div>
      </section>

      <footer>
        ¬© <span id="year"></span> FlixPro ‚Äî built with ‚ù§Ô∏è ‚Ä¢ Template siap pakai
      </footer>
    </main>
  </div>

  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="modal-card" role="dialog" aria-modal="true">
      <button class="close" id="closeModal">‚úï</button>
      <div class="modal-top">
        <div class="modal-video" id="modalVideo"></div>
        <div class="modal-info" id="modalInfo">
          <h3 id="modalTitle">Judul Film</h3>
          <p class="muted" id="modalMeta">Genre ‚Ä¢ Tahun ‚Ä¢ Durasi</p>
          <p style="margin-top:12px" id="modalDesc">Deskripsi singkat film akan muncul di sini.</p>
          <div style="margin-top:16px">
            <button class="pill" id="watchlistBtn">Tambah ke Watchlist</button>
            <a id="imdbLink" class="muted" href="#" target="_blank" style="display:inline-block;margin-left:12px">Lihat di IMDB ‚Üí</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    /* CONFIG - ganti API_KEY di environment / serverless untuk produksi */
    const BLOG_ID = "4521274187180591519"; // dari kamu
    const API_KEY = "AIzaSyA8k0Fr9m-7zsC1EzdOjI3kgMR92bJHs_E"; // TIDAK masukkan API key ke repo publik. Untuk testing lokal, isi di sini.
    const API_PROXY = ""; // Optional: URL serverless function proxy (lebih aman)

    // Fallback sample movies (dipakai saat API_KEY kosong)
    const sampleMovies = [
      {id:1,title:'A New Dawn',genre:'Action',year:2024,duration:'2h 11m',rating:8.5,thumb:'https://images.unsplash.com/photo-1505685296765-3a2736de412f?q=80&w=800&auto=format&fit=crop',poster:'https://images.unsplash.com/photo-1505685296765-3a2736de412f?q=80&w=1600&auto=format&fit=crop',desc:'Aksi non-stop dan visual menawan dalam petualangan menyelamatkan dunia.',trailer:'https://www.youtube.com/embed/ysz5S6PUM-U'},
      {id:2,title:'Moonlight Sonata',genre:'Drama',year:2023,duration:'1h 48m',rating:7.9,thumb:'https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?q=80&w=800&auto=format&fit=crop',poster:'https://images.unsplash.com/photo-1524985069026-dd778a71c7b4?q=80&w=1600&auto=format&fit=crop',desc:'Drama emosional tentang cinta dan kehilangan.',trailer:'https://www.youtube.com/embed/aqz-KE-bpKQ'},
      {id:3,title:'Laugh Riot',genre:'Comedy',year:2022,duration:'1h 30m',rating:7.1,thumb:'https://images.unsplash.com/photo-1515165562835-c3a6e4e8e6a0?q=80&w=800&auto=format&fit=crop',poster:'https://images.unsplash.com/photo-1515165562835-c3a6e4e8e6a0?q=80&w=1600&auto=format&fit=crop',desc:'Komedi cepat yang cocok untuk nonton santai.',trailer:'https://www.youtube.com/embed/5qap5aO4i9A'}
    ];

    // DOM refs
    const grid = document.getElementById('grid');
    const q = document.getElementById('q');
    const filters = document.getElementById('filters');
    const trendingList = document.getElementById('trendingList');
    const playHero = document.getElementById('playHero');
    const heroPoster = document.getElementById('heroPoster');
    const modal = document.getElementById('modal');
    const modalVideo = document.getElementById('modalVideo');
    const modalTitle = document.getElementById('modalTitle');
    const modalDesc = document.getElementById('modalDesc');
    const modalMeta = document.getElementById('modalMeta');
    const closeModal = document.getElementById('closeModal');
    const yearEl = document.getElementById('year');
    const loadMore = document.getElementById('loadMore');
    const heroTitle = document.getElementById('heroTitle');
    const heroMeta = document.getElementById('heroMeta');
    const heroDesc = document.getElementById('heroDesc');
    const heroRating = document.getElementById('heroRating');

    yearEl.textContent = new Date().getFullYear();

    let allMovies = []; // array of movie objects used by UI
    let visible = 8;
    let activeGenre = 'All';
    let currentIndex = 0;

    // Utilities
    function extractYouTubeFromContent(html){
      const div = document.createElement('div'); div.innerHTML = html;
      const iframe = div.querySelector('iframe');
      if(iframe){
        const src = iframe.src || iframe.getAttribute('data-src');
        // normalize to embed URL
        return src;
      }
      return null;
    }

    function extractFirstImage(html){
      const div = document.createElement('div'); div.innerHTML = html;
      const img = div.querySelector('img');
      if(img) return img.src;
      return null;
    }

    // Parse Blogger posts into movie objects
    function mapPostsToMovies(posts){
      return posts.map((p, idx) => {
        const content = p.content || '';
        const trailer = extractYouTubeFromContent(content);
        const poster = extractFirstImage(content) || (p.images && p.images[0] && p.images[0].url) || '';
        const genres = (p.labels && p.labels.length) ? p.labels : ['Uncategorized'];
        return {
          id: p.id || idx,
          title: p.title || 'No title',
          genre: genres[0],
          labels: genres,
          year: p.published ? new Date(p.published).getFullYear() : '',
          duration: '',
          rating: '',
          thumb: poster || 'https://via.placeholder.com/800x450?text=No+Image',
          poster: poster || 'https://via.placeholder.com/1600x900?text=No+Poster',
          desc: p.content ? (p.content.replace(/<[^>]+>/g, '').slice(0,200) + '...') : '',
          trailer: trailer || ''
        };
      });
    }

    // Fetch posts from Blogger API (search by label optional)
    async function fetchPosts({label=null,maxResults=20}={}){
      // choose endpoint: use proxy if set for safety
      let url;
      if(API_PROXY){
        // Proxy expects ?blogId=...&label=...
        url = `${API_PROXY}?blogId=${BLOG_ID}&label=${encodeURIComponent(label||'')}&maxResults=${maxResults}`;
      } else if(API_KEY){
        if(label){
          url = `https://www.googleapis.com/blogger/v3/blogs/${BLOG_ID}/posts/search?q=label:${encodeURIComponent(label)}&key=${API_KEY}&maxResults=${maxResults}`;
        } else {
          url = `https://www.googleapis.com/blogger/v3/blogs/${BLOG_ID}/posts?key=${API_KEY}&maxResults=${maxResults}`;
        }
      } else {
        // No API configured ‚Äî return sample movies as fallback
        return sampleMovies;
      }

      const res = await fetch(url);
      if(!res.ok) throw new Error('Failed to fetch posts: ' + res.status);
      const data = await res.json();
      return mapPostsToMovies(data.items || []);
    }

    async function loadInitial(){
      try{
        // load movies (either from Blogger or fallback)
        const movies = await fetchPosts({maxResults:50});
        allMovies = movies.length ? movies : sampleMovies;
        populateGenreChips(allMovies);
        renderTrending();
        setHero(0);
        renderGrid();
      }catch(e){
        console.error(e);
        // fallback
        allMovies = sampleMovies;
        populateGenreChips(allMovies);
        renderTrending();setHero(0);renderGrid();
      }
    }

    function populateGenreChips(list){
      const genres = new Set(['All']);
      list.forEach(m=>{ if(m.genre) genres.add(m.genre); if(m.labels) m.labels.forEach(l=>genres.add(l)); });
      filters.innerHTML = '';
      Array.from(genres).forEach(g=>{
        const b = document.createElement('button'); b.className='chip'+(g==='All'? ' active':''); b.dataset.genre=g; b.textContent=g; filters.appendChild(b);
      });
    }

    function renderGrid(){
      grid.innerHTML = '';
      const qv = q.value.trim().toLowerCase();
      const filtered = allMovies.filter(m=>{
        if(activeGenre !== 'All' && !m.labels.includes(activeGenre) && m.genre !== activeGenre) return false;
        if(qv && !(m.title.toLowerCase().includes(qv) || (m.genre && m.genre.toLowerCase().includes(qv)))) return false;
        return true;
      });
      const toShow = filtered.slice(0,visible);
      toShow.forEach((m,i)=>{
        const el = document.createElement('div');el.className='card';el.tabIndex=0;el.setAttribute('role','button');
        el.innerHTML = `
          <div class="thumb"><img src="${m.thumb}" alt="${m.title}"></div>
          <div class="info">
            <h3 class="title-small">${m.title}</h3>
            <div class="meta-row"><span class="muted">${m.genre}</span><span class="muted">${m.rating? '‚≠ê ' + m.rating : ''}</span></div>
            <div class="muted" style="margin-top:8px;font-size:13px">${m.year} ‚Ä¢ ${m.duration}</div>
          </div>`;
        el.addEventListener('click',()=>openModal(m));
        el.addEventListener('keypress',(e)=>{if(e.key==='Enter')openModal(m)});
        grid.appendChild(el);
      });
      loadMore.style.display = filtered.length > visible ? 'inline-block' : 'none';
    }

    function renderTrending(){
      trendingList.innerHTML='';
      const slice = allMovies.slice(0,6);
      slice.forEach((m,idx)=>{
        const it = document.createElement('div');it.className='mini-item';
        it.innerHTML = `<img src="${m.thumb}" alt="${m.title}"><div><div class="t">${m.title}</div><div class="muted" style="font-size:12px">${m.genre} ‚Ä¢ ${m.year}</div></div>`;
        it.addEventListener('click',()=>openModal(m));
        trendingList.appendChild(it);
      });
    }

    function setHero(index){
      currentIndex = index || 0;
      const m = allMovies[currentIndex];
      if(!m) return;
      heroPoster.querySelector('img').src = m.poster || m.thumb;
      heroTitle.textContent = m.title;
      heroMeta.textContent = `${m.genre} ‚Ä¢ ${m.year} ‚Ä¢ ${m.duration}`;
      heroDesc.textContent = m.desc;
      heroRating.textContent = m.rating? '‚≠ê ' + m.rating : '';
    }

    function openModal(m){
      modal.classList.add('open');
      modalTitle.textContent = m.title;
      modalDesc.textContent = m.desc;
      modalMeta.textContent = `${m.genre} ‚Ä¢ ${m.year} ‚Ä¢ ${m.duration}`;
      modalVideo.innerHTML = m.trailer ? `<iframe width="100%" height="100%" src="${m.trailer}?autoplay=1&rel=0" title="Trailer ${m.title}" frameborder="0" allowfullscreen allow="autoplay; encrypted-media"></iframe>` : `<div style="display:grid;place-items:center;height:100%;color:var(--muted)">No trailer available</div>`;
      document.body.style.overflow = 'hidden';
    }

    function close(){
      modal.classList.remove('open');
      modalVideo.innerHTML = '';
      document.body.style.overflow = '';
    }

    // event bindings
    q.addEventListener('input',()=>{visible=8;renderGrid();});
    filters.addEventListener('click',(e)=>{
      const btn = e.target.closest('.chip');
      if(!btn) return;
      [...filters.querySelectorAll('.chip')].forEach(c=>c.classList.remove('active'));
      btn.classList.add('active');
      activeGenre = btn.dataset.genre || 'All';
      visible = 8;renderGrid();
    });
    document.querySelectorAll('[data-year]').forEach(b=>b.addEventListener('click',()=>{const y=b.dataset.year; q.value=y; visible=8; renderGrid();}));
    playHero.addEventListener('click',()=>{openModal(allMovies[0]);});
    closeModal.addEventListener('click',close);
    modal.addEventListener('click',(e)=>{if(e.target===modal)close();});
    loadMore.addEventListener('click',()=>{visible += 8; renderGrid();});

    // Watchlist
    function watchlistAdd(movie){
      const list = JSON.parse(localStorage.getItem('watchlist')||'[]');
      if(list.find(m=>m.id===movie.id)) return; list.push(movie); localStorage.setItem('watchlist',JSON.stringify(list));
      alert('Ditambahkan ke watchlist');
    }
    document.getElementById('addHero').addEventListener('click',()=>{watchlistAdd(allMovies[currentIndex]);});
    document.getElementById('watchlistBtn').addEventListener('click',()=>{watchlistAdd(allMovies[currentIndex]);});

    // Dark toggle
    const darkToggle = document.getElementById('darkToggle');
    darkToggle.addEventListener('click',()=>{document.documentElement.style.setProperty('--accent', getComputedStyle(document.documentElement).getPropertyValue('--accent').trim()==='#ff5a5f' ? '#6ce2ff' : '#ff5a5f');darkToggle.textContent = darkToggle.textContent === 'üåô' ? '‚òÄÔ∏è' : 'üåô';});

    // Keyboard next/prev
    window.addEventListener('keydown',(e)=>{
      if(modal.classList.contains('open')){
        if(e.key==='ArrowRight'){
          // close and go next
          close(); currentIndex = (currentIndex + 1) % allMovies.length; setHero(currentIndex); openModal(allMovies[currentIndex]);
        }
        if(e.key==='ArrowLeft'){
          close(); currentIndex = (currentIndex - 1 + allMovies.length) % allMovies.length; setHero(currentIndex); openModal(allMovies[currentIndex]);
        }
      } else {
        if(e.key === '/' && document.activeElement !== q){ e.preventDefault(); q.focus(); }
        if(e.key==='n'){ currentIndex = (currentIndex + 1) % allMovies.length; setHero(currentIndex); }
        if(e.key==='p'){ currentIndex = (currentIndex - 1 + allMovies.length) % allMovies.length; setHero(currentIndex); }
      }
    });

    // init
    loadInitial();

  </script>
</body>
</html>
