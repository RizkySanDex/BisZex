<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Video Site</title>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:#111;
  color:white;
}

/* HEADER */
header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:10px 15px;
  background:#000;
  border-bottom:1px solid #222;
}

.site-name{
  font-size:22px;
  font-weight:bold;
}

.header-ad{
  width:320px;
  height:50px;
  display:flex;
  justify-content:center;
  align-items:center;
}

.search-box input{
  padding:7px 12px;
  width:150px;
  border-radius:6px;
  border:none;
}

/* GRID VIDEO */
.video-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit, minmax(250px, 1fr));
  gap:20px;
  padding:15px;
}

.video-card{
  background:#1a1a1a;
  border-radius:10px;
  overflow:hidden;
  cursor:pointer;
  transition:.2s;
}

.video-card:hover{
  transform:scale(1.03);
}

.video-card img{
  width:100%;
  aspect-ratio:16/9;
  object-fit:cover;
}

.video-title{
  padding:10px;
  font-size:16px;
  height:55px;
  overflow:hidden;
}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.9);
  display:none;
  align-items:center;
  justify-content:center;
  padding:10px;
  z-index:999999;
}

.modal.open{
  display:flex;
}

.modal-box{
  width:95%;
  max-width:1100px;
  background:#111;
  border-radius:12px;
  overflow:hidden;
  display:flex;
  flex-direction:row;
  gap:15px;
  padding:15px;
  position:relative;
}

.modal-video-wrap{
  flex:3;
  background:black;
  border-radius:10px;
  overflow:hidden;
}

.modal-video-wrap iframe{
  width:100%;
  height:100%;
  border:0;
}

.modal-ad{
  flex:1;
  min-width:300px;
  height:250px;
  display:flex;
  align-items:center;
  justify-content:center;
}

/* CLOSE BUTTON */
.modal-close{
  position:absolute;
  top:8px;
  right:12px;
  font-size:28px;
  color:white;
  background:none;
  border:none;
  cursor:pointer;
  z-index:10;
}

/* RESPONSIVE MOBILE */
@media(max-width:768px){
  .modal-box{
    flex-direction:column;
    width:100%;
    height:100%;
    max-width:100%;
    padding:10px;
  }

  .modal-video-wrap{
    height:55vh;
  }

  .modal-ad{
    width:100%;
    min-width:100%;
    height:auto;
    margin-top:10px;
  }

  .modal-ad iframe{
    width:100% !important;
    height:90px !important;
  }
}
</style>
</head>

<body>

<header>
  <div class="site-name">Video Site</div>

  <div class="header-ad">
<script type="text/javascript">
	atOptions = {
		'key' : 'f911d9fd4c8cadde096c6bfbf9d30630',
		'format' : 'iframe',
		'height' : 50,
		'width' : 320,
		'params' : {}
	};
</script>
<script type="text/javascript" src="//www.highperformanceformat.com/f911d9fd4c8cadde096c6bfbf9d30630/invoke.js"></script>
  </div>

  <div class="search-box">
    <input type="text" placeholder="Cari Video">
  </div>
</header>

<div class="video-grid" id="videoGrid"></div>

<!-- MODAL -->
<div id="videoModal" class="modal">
  <div class="modal-box">

    <button class="modal-close" id="closeModal">&times;</button>

    <div class="modal-video-wrap" id="modalVideo"></div>

    <div class="modal-ad" id="modalAd">
      <script type="text/javascript">
        atOptions = {
          'key' : 'c4f0b959a9c4b12d8d039c71b3c3e1ec',
          'format' : 'iframe',
          'height' : 250,
          'width' : 300,
          'params' : {}
        };
      </script>
      <script type="text/javascript" src="//www.highperformanceformat.com/c4f0b959a9c4b12d8d039c71b3c3e1ec/invoke.js"></script>
    </div>

  </div>
</div>

<script>
function openModal(src){
  modalVideo.innerHTML = `<iframe src="${src}?autoplay=1" allowfullscreen></iframe>`;
  document.getElementById("videoModal").classList.add("open");
}

document.getElementById("closeModal").onclick = ()=>{
  document.getElementById("videoModal").classList.remove("open");
  modalVideo.innerHTML="";
};

/* LOAD BLOGGER POSTING via JSONP */
function loadBlogger(){
  const blogID = "4521274187180591519";

  let url = `https://www.blogger.com/feeds/${blogID}/posts/default?alt=json-in-script&callback=renderPosts&max-results=50`;

  let script = document.createElement("script");
  script.src = url;
  document.body.appendChild(script);
}

function renderPosts(data){
  let entries = data.feed.entry;
  let grid = document.getElementById("videoGrid");

  entries.forEach(post=>{
    let title = post.title.$t;

    let content = post.content.$t;

    let thumbMatch = content.match(/<div class="thumbnail">(.*?)<\/div>/s);
    let thumb = thumbMatch ? thumbMatch[1].trim() : "";

    let videoMatch = content.match(/<div class="video_url">([\s\S]*?)<\/div>/);
    let iframeRaw = videoMatch ? videoMatch[1] : "";

    grid.innerHTML += `
      <div class="video-card" onclick="openModal(\`${extractSrc(iframeRaw)}\`)">
        <img src="${thumb}" alt="">
        <div class="video-title">${title}</div>
      </div>
    `;
  });
}

function extractSrc(html){
  let match = html.match(/src="([^"]+)"/);
  return match ? match[1] : "";
}

loadBlogger();
</script>

</body>
</html>
