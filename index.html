<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Aisah-Video</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:"Segoe UI",Arial,sans-serif;background:#f7f7f7;color:#222}
.container{width:94%;max-width:1150px;margin:20px auto}
header{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;margin-bottom:10px}
.logo{display:flex;align-items:center;gap:8px}
.logo i{font-size:1.6rem;color:#ff5314}
.logo h1{font-size:1.2rem;font-weight:700;display:inline-block;}
.ad-top{margin-left:10px;flex-shrink:0;}
.search-bar{flex:1;display:flex;max-width:520px;margin-left:12px;min-width:200px}
.search-bar input{flex:1;padding:9px 12px;border:1px solid #ddd;border-radius:6px 0 0 6px}
.search-bar button{background:#2a2a2a;color:white;padding:0 14px;border-radius:0 6px 6px 0}
.nav-links a{margin-left:12px;color:#777;text-decoration:none;font-size:.9rem}

.filters-container{position:relative;margin:14px 0;overflow:hidden;}
.filters-scroll{display:flex;gap:8px;overflow-x:auto;padding-bottom:8px;scrollbar-width:none;}
.filters-scroll::-webkit-scrollbar{display:none}
.filter-btn{padding:8px 14px;border:1px solid #eee;border-radius:20px;background:#fff;cursor:pointer;color:#666;font-weight:600;font-size:0.87rem;white-space:nowrap;flex-shrink:0;}
.filter-btn.active{background:#ff5314;color:#fff;border-color:#ff5314}

.video-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:16px}
.video-card{background:white;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.06);overflow:hidden;transition:.2s;cursor:pointer}
.video-card:hover{transform:translateY(-6px)}
.video-thumb{position:relative;width:100%;aspect-ratio:16/9;background:#f3f3f3}
.video-thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
.video-info{padding:10px}
.video-info h3{font-size:0.78rem;font-weight:500;line-height:1.2;height:36px;overflow:hidden;text-overflow:ellipsis}

/* MODAL STYLING */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.85);display:none;align-items:center;justify-content:center;padding:5px;z-index:1500;}
.modal.open{display:flex}
.modal-box{background:white;width:100%;max-width:1000px;max-height:95vh;border-radius:12px;overflow:hidden;display:flex;flex-direction:column;position:relative;box-shadow:0 20px 60px rgba(0,0,0,.35)}
.modal-close{position:absolute;top:10px;right:10px;width:35px;height:35px;border-radius:50%;background:rgba(0,0,0,.45);color:white;font-size:20px;display:flex;align-items:center;justify-content:center;cursor:pointer;border:none;z-index:10}

.modal-content-row{display:flex;gap:10px;flex:1;overflow:auto;align-items:flex-start}
.modal-left{flex:2}
.modal-right{flex:1;display:flex;flex-direction:column;gap:6px}

.modal-video-wrap{position:relative;width:100%;aspect-ratio:16/9;background:black}
.modal-video-wrap iframe,.modal-video-wrap video{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;border:0}

.image-grid{display:grid;grid-template-columns:repeat(auto-fill,70px);grid-auto-rows:70px;gap:5px;justify-content:start}
.image-grid img{width:70px;height:70px;object-fit:cover;border-radius:6px;cursor:pointer;border:1px solid #eee;background:#f3f3f3}

.modal-details{padding:10px 12px;border-top:1px solid #eee;margin-top:-4px}
.modal-details h3{font-size:1.1rem;margin-bottom:6px;text-align:left;}

/* MEDIA QUERIES MOBILE */
@media(max-width:768px){
    header{flex-direction:column;align-items:stretch;gap:10px}
    .search-bar{margin-left:0;max-width:100%}
    .video-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:12px}
    .modal-content-row{flex-direction:column}
    .modal-right{flex:none;order:2;align-items:center}
    .image-grid{grid-template-columns:repeat(auto-fill,60px);grid-auto-rows:60px;justify-content:center}
    .modal-video-wrap{aspect-ratio:16/9}
}
@media(max-width:480px){
    .video-grid{grid-template-columns:repeat(2,1fr);gap:10px}
    .video-info h3{font-size:0.75rem;height:32px}
    .image-grid{grid-template-columns:repeat(auto-fill,50px);grid-auto-rows:50px}
}
</style>
</head>
<body>
<div class="container">
    <!-- HEADER -->
    <header>
        <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;">
            <div class="logo"><i class="fas fa-play-circle"></i><h1>Aisah-Video</h1></div>
            <div class="ad-top">
                <!-- Adsterra 320x50 Header -->
                <script type="text/javascript" src="https://www.adriver.ru/cgi-bin/erle.cgi?sid=XXXX&type=script&ad=AAAA"></script>
            </div>
            <div class="search-bar">
                <input id="searchInput" type="text" placeholder="Cari video...">
                <button><i class="fas fa-search"></i></button>
            </div>
        </div>
        <nav class="nav-links">
            <a>Beranda</a>
            <a>Kategori</a>
        </nav>
    </header>

    <!-- FILTER -->
    <div class="filters-container">
        <div class="filters-scroll">
            <button class="filter-btn active">Semua</button>
            <button class="filter-btn">Action</button>
            <button class="filter-btn">Drama</button>
            <button class="filter-btn">Anime</button>
        </div>
    </div>

    <!-- VIDEO GRID -->
    <div id="videoContainer" class="video-grid"></div>
</div>

<!-- MODAL VIDEO -->
<div id="videoModal" class="modal">
    <div class="modal-box">
        <button class="modal-close" id="closeModal">&times;</button>
        <div class="modal-content-row">
            <div class="modal-left">
                <div class="modal-video-wrap" id="modalVideo"></div>
            </div>
            <div class="modal-right">
                <!-- Adsterra 300x250 -->
                <script type="text/javascript" src="https://www.adriver.ru/cgi-bin/erle.cgi?sid=XXXX&type=script&ad=BBBB"></script>
                <div class="image-grid" id="imageGallery"></div>
            </div>
        </div>
        <div class="modal-details">
            <h3 id="modalTitle"></h3>
            <!-- Adsterra 320x50 bawah judul -->
            <script type="text/javascript" src="https://www.adriver.ru/cgi-bin/erle.cgi?sid=XXXX&type=script&ad=CCCC"></script>
        </div>
    </div>
</div>

<script>
const BLOG_ID="4521274187180591519";
const API_KEY="AIzaSyA8k0Fr9m-7zsC1EzdOjI3kgMR92bJHs_E";
const videoContainer=document.getElementById("videoContainer");
let currentVideos=[];

function parseHTML(post){return new DOMParser().parseFromString(post.content||"","text/html")}
function extractThumbnail(p){
    const doc=parseHTML(p);
    const iframe=doc.querySelector("iframe");
    if(iframe){
        const src=iframe.src;
        // YouTube thumbnail extraction
        const ytMatch=src.match(/(?:youtube\.com\/embed\/|youtu\.be\/)([\w-]{11})/);
        if(ytMatch) return `https://img.youtube.com/vi/${ytMatch[1]}/hqdefault.jpg`;
    }
    return doc.querySelector("img")?.src||"https://via.placeholder.com/600x400?text=No+Image";
}
function extractVideoUrl(p){const doc=parseHTML(p);return doc.querySelector("iframe")?.src||"";}
function extractGallery(p){const doc=parseHTML(p);const raw=doc.querySelector(".gallery")?.textContent?.trim();if(!raw)return[];return raw.split(",").map(x=>x.trim()).filter(x=>x.length>5);}

async function loadVideos(){
    const url=`https://www.googleapis.com/blogger/v3/blogs/${BLOG_ID}/posts?key=${API_KEY}&maxResults=30`;
    const res=await fetch(url);
    const data=await res.json();
    currentVideos=data.items.map(p=>({
        id:p.id,
        title:p.title,
        thumbnail:extractThumbnail(p),
        videoUrl:extractVideoUrl(p),
        gallery:extractGallery(p),
        labels:p.labels||[]
    }));
    renderList(currentVideos);
    initFilters();
}

function renderList(list){
    videoContainer.innerHTML="";
    list.forEach(v=>{
        const card=document.createElement("div");
        card.className="video-card";
        card.innerHTML=`
            <div class="video-thumb"><img src="${v.thumbnail}" alt="${v.title}"></div>
            <div class="video-info"><h3>${v.title}</h3></div>
        `;
        card.onclick=()=>openModal(v.id);
        videoContainer.appendChild(card);
    });
}

function openModal(id){
    const v=currentVideos.find(x=>x.id===id);
    if(!v)return;
    document.getElementById("modalTitle").textContent=v.title;
    document.getElementById("modalVideo").innerHTML=`<iframe src="${v.videoUrl}?autoplay=1" allowfullscreen></iframe>`;
    const grid=document.getElementById("imageGallery");
    grid.innerHTML="";
    v.gallery.forEach((src,i)=>{
        const img=document.createElement("img");
        img.src=src;
        img.alt=`Gambar ${i+1}`;
        grid.appendChild(img);
    });
    document.getElementById("videoModal").classList.add("open");
}

document.getElementById("closeModal").onclick=()=>{document.getElementById("videoModal").classList.remove("open");document.getElementById("modalVideo").innerHTML="";};

function initFilters(){
    document.querySelectorAll('.filter-btn').forEach(btn=>{
        btn.onclick=()=>{
            document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
            btn.classList.add('active');
            const label=btn.textContent.trim().toLowerCase();
            if(label==="semua"){renderList(currentVideos);}
            else{
                const filtered=currentVideos.filter(v=>(v.labels||[]).map(x=>x.toLowerCase()).includes(label));
                renderList(filtered);
            }
        };
    });
}

document.querySelector('.search-bar button').addEventListener('click', performSearch);
document.getElementById('searchInput').addEventListener('keypress', function(e){if(e.key==='Enter'){performSearch();}});
function performSearch(){
    const searchTerm=document.getElementById('searchInput').value.toLowerCase().trim();
    if(searchTerm===''){renderList(currentVideos);return;}
    const filtered=currentVideos.filter(v=>v.title.toLowerCase().includes(searchTerm));
    renderList(filtered);
}

loadVideos();
</script>
</body>
</html>
